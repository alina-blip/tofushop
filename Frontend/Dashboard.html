<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kontakt</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
    crossorigin="anonymous"
  />
  <link rel="stylesheet" href="style-basics.css"/>
  <link rel="stylesheet" href="style-contact.css"/>
  <link rel="stylesheet" href="style-grid-images.css"/>
  <link rel="stylesheet" href="style-nav.css"/>
  <link rel="stylesheet" href="style-tofu-word-animation.css"/>
  <link rel="stylesheet" href="styles-rest.css"/>
  <link rel="stylesheet" href="https://use.typekit.net/tju5ord.css"/>
  <script
    src="https://code.jquery.com/jquery-3.6.3.min.js"
    integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
    crossorigin="anonymous"
  ></script>
  <script src="components/navbar/loadNavbar.js" defer></script>
  <style>
      .cart-container {
          padding-top: 35px;
      }

      .cart {
          border: 1px solid #ccc;
          padding: 25px;
          max-width: 700px;
          margin: 7px auto auto;
      }

      .product {
          border: 1px solid #ccc;
          padding: 25px;
          margin: 7px auto auto;
      }

      .cart h2 {
          text-align: center;
      }

      .cart-item {
          display: flex;
          justify-content: space-between;
          margin-bottom: 15px;
          margin-top: 20px;
          border-bottom: 1px solid #ccc;
      }

      /* Media query for screens smaller than 768px (sm) */
      @media screen and (max-width: 1200px) {
          .cart-item {
              display: block; /* Display items in a single column on smaller screens */
          }
      }

      .cart-item img {
          max-width: 100vh;
          max-height: 100px;
          margin-right: 10px;
      }

      .cart-item button {
          padding: 5px 10px;
          cursor: pointer;
          margin-bottom: 15px;
      }


      .container-grid-shop {
          padding: 30px;
          max-width: 1300px;
          margin: auto;
      }

  </style>
</head>
<body>
<div id="page-container">
  <div id="content-wrap">
    <div id="navbarContainer"></div>
    <div id="container-nav-phone"></div>
    <!--    <div class="container-grid-shop">-->
    <!--      <div class="row">-->
    <!--        <div class="col-lg-6 col-md-6 col-sm-12 ">-->
    <!--          <div class="cart-container">-->

    <!--            //////////////////////////////////////////////////////////////-->
    <!--            ////////////// NAVIGATION ADMIN /////////////////////-->
    <!--            //////////////////////////////////////////////////////////////-->

    <div class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid justify-content-center">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="#" id="showUsersButton">Benutzer</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" id="showOrdersButton">Bestellungen</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" id="showProductsButton">Produkte</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" id="showNewProductButton">Neues Produkt</a>
          </li>
        </ul>
      </div>
    </div>

    <!--            //////////////////////////////////////////////////////////////-->
    <!--            ////////////// USERLIST /// ORDERLIST /// PRODUCTLIST /////////////////////-->
    <!--            //////////////////////////////////////////////////////////////-->

    <div class="container-fluid h-100">
      <div class="row h-100">
        <div class="col-md-12 text-center align-self-center">
          <div class="container">
        <span id="userList">
          <div id="noUsersMessage" style="display: none;">No user is registered.</div>
        </span>
            <span id="ordersList">
          <div id="noOrdersMessage" style="display: none;">No orders received.</div>
        </span>
            <span id="productsList">
          <div id="noProductsMessage" style="display: none;">No products in store.</div>
        </span>
          </div>
        </div>
      </div>
    </div>


    <!--          //////////////////////////////////////////////////////////////-->
    <!--          ////////////// ADD PRODUCT FORM /////////////////////-->
    <!--          //////////////////////////////////////////////////////////////-->

    <div id="addNewProduct">
      <div class="container">
        <form id="productForm" action="http://localhost:8080/original" method="POST">
          <div class="mb-3">
            <label for="title" class="form-label">Titel</label>
            <input
              type="text"
              class="form-control"
              id="title"
              name="title"
              required
            />
          </div>
          <div class="mb-3">
            <input
              type="text"
              class="form-control"
              placeholder="Grösse"
              id="size"
              name="size"
              required
            />
          </div>
          <div class="mb-3">
            <input
              type="text"
              class="form-control"
              placeholder="Material"
              id="material"
              name="material"
              required
            />
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Beschreibung</label>
            <input
              type="text"
              class="form-control"
              placeholder="Das ist ein Bild von einem ..."
              id="description"
              name="description"
              required
            />
          </div>
          <div class="mb-3">
            <label for="quantity" class="form-label">Quantität</label>
            <input
              type="number"
              class="form-control"
              placeholder="25"
              id="quantity"
              name="quantity"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Kategorie</label>
            <div class="form-check">
              <input
                type="radio"
                class="form-check-input"
                name="category"
                value="ORIGINAL"
                required
              />
              <label class="form-check-label">Original</label>
            </div>
            <div class="form-check">
              <input
                type="radio"
                class="form-check-input"
                name="category"
                value="STICKER"
                required
              />
              <label class="form-check-label">Sticker</label>
            </div>
            <div class="form-check">
              <input
                type="radio"
                class="form-check-input"
                name="category"
                value="PRINT"
                required
              />
              <label class="form-check-label">Print</label>
            </div>
          </div>
          <div class="mb-3">
            <label for="price" class="form-label">Preis in €</label>
            <input
              type="number"
              class="form-control"
              placeholder="Preis in €"
              id="price"
              name="price"
              required
            />
          </div>
          <div class="mb-3">
            <label for="url" class="form-label">URL</label>
            <input
              type="text"
              class="form-control"
              placeholder="URL"
              id="url"
              name="url"
            />
          </div>
          <div class="mb-3">
            <button type="submit" class="btn btn-dark">Produkt hinzufügen</button>
          </div>
        </form>
      </div>
    </div>

    <!--          //////////////////////////////////////////////////////////////-->
    <!--          ////////////// BESTELLUNGEN /////////////////////-->
    <!--          //////////////////////////////////////////////////////////////-->

    <!--          <div class="col-lg-6 col-md-6 col-sm-12 ">-->
    <!--            <div class="cart-container">-->
    <!--              <h2>Bestellungen</h2>-->
    <!--              <div class="cart">-->
    <!--                <div class="register-container">-->
    <!--                  <button>Change Status</button>-->
    <!--                </div>-->
    <!--                <p>Status: Sent</p>-->
    <!--                <p>Rechnungsnummer: 3330004999</p>-->
    <!--                <p>Kunde: Alina Sorger</p>-->
    <!--                <div class="cart-item">-->
    <!--                  <img src="product1.jpg" alt="Product 1">-->
    <!--                  <p>Product 1</p>-->
    <!--                  <p>$19.99</p>-->
    <!--                  <p>1 Stk</p>-->
    <!--                </div>-->
    <!--                <div class="cart-item">-->
    <!--                  <img src="product2.jpg" alt="Product 2">-->
    <!--                  <p>Product 2</p>-->
    <!--                  <p>$24.99</p>-->
    <!--                  <p>5 Stk</p>-->
    <!--                </div>-->
    <!--                <p>Total: 330,00</p>-->
    <!--              </div>-->

  </div>

<footer class="footer">
  <div class="footer-element">
    <a class="link" href="Hilfe.html">Hilfe</a>
  </div>
  <div class="footer-element">
    <a class="link" href="Impressum.html">Impressum</a>
  </div>
  <div class="footer-element">
    <a class="link" href="Kontakt.html">Kontakt</a>
  </div>
</footer>
</div>
</body>
</html>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
  crossorigin="anonymous"
></script>
<script>
    $(document).ready(function () {
        // Initial state:  "Registrierte Benutzer"
        // $('#userList').show();
        showUsers();
        function showUsers() {
            $('#userList').show();
            $('#ordersList').hide();
            $('#productsList').hide();
            $('#addNewProduct').hide();
            $('.cart-container h2').text('Registrierte Benutzer');
        }
        function showOrders() {
            $('#userList').hide();
            $('#ordersList').show();
            $('#productsList').hide();
            $('#addNewProduct').hide();
            $('.cart-container h2').text('Bestellungen');

        }
        function showProducts() {
            $('#userList').hide();
            $('#ordersList').hide();
            $('#productsList').show();
            $('#addNewProduct').hide();
            $('.cart-container h2').text('Produkte');

        }
        function showNewProductForm() {
            $('#userList').hide();
            $('#ordersList').hide();
            $('#productsList').hide();
            $('#addNewProduct').show();
            $('.cart-container h2').text('Produkt hinzufügen');
        }
        $('#showUsersButton').click(showUsers);
        $('#showOrdersButton').click(showOrders);
        $('#showProductsButton').click(showProducts);
        $('#showNewProductButton').click(showNewProductForm);

    });

</script>
<script>
    $(document).ready(function () {
        $.ajax({
            url: 'http://localhost:8080/user',
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                if (data.length === 0) {
                    $('#noUsersMessage').show();
                } else {
                    data.forEach(function (user) {
                        var userDiv = $('<div class="cart"></div>');
                        userDiv.append('<p>ID: ' + user.id + '</p>');
                        userDiv.append('<p>Nachname: <span class="user-name">' + user.name + '</span></p>');
                        userDiv.append('<p>Vorname: ' + user.surname + '</p>');
                        userDiv.append('<p>Straße: ' + user.street + '</p>');
                        userDiv.append('<p>Hausnummer: ' + user.housenumber + '</p>');
                        userDiv.append('<p>PLZ: ' + user.postalcode + '</p>');
                        userDiv.append('<p>Ort: ' + user.country + '</p>');
                        userDiv.append('<p>E-mail: ' + user.email + '</p>');

                        var changeNameButton = $('<div class="register-container" id="changeNameButton"><button>Name ändern</button></div>');
                        var changePasswordButton = $('<div class="register-container" id="changePasswordButton"><button>Passwort ändern</button></div>');
                        var deactivateButton = $('<div class="register-container"><button>Deaktivieren</button></div>');

                        userDiv.append('').append(changeNameButton);
                        userDiv.append('').append(changePasswordButton);
                        userDiv.append('').append(deactivateButton);

                        $('#userList').append(userDiv);

                        deactivateButton.click(function () {
                            var newUserData = {
                                id: user.id,
                            };

                            console.log(newUserData);

                            $.ajax({
                                url: 'http://localhost:8080/user/' + user.id,
                                method: 'DELETE',
                                success: function (response) {
                                    console.log('User deleted successfully');
                                    location.reload();
                                },
                                error: function (xhr, status, error) {
                                    console.error('Error deleting user:', xhr, status, error);
                                }
                            });
                        });
                        changePasswordButton.click(function () {
                            var passwordInput = $('<input type="password">');
                            var savePasswordButton = $('<div class="register-container"><button>Speichern</button></div>');

                            userDiv.empty()
                                .append('<p>ID: ' + user.id + '</p>')
                                .append('<p>Nachname: <span class="user-name">' + user.name + '</span></p>')
                                .append('<p>Vorname: ' + user.surname + '</p>')
                                .append('<p>Straße: ' + user.street + '</p>')
                                .append('<p>Hausnummer: ' + user.housenumber + '</p>')
                                .append('<p>PLZ: ' + user.postalcode + '</p>')
                                .append('<p>Ort: ' + user.country + '</p>')
                                .append('<p>E-mail: ' + user.email + '</p>')
                                .append(passwordInput)
                                .append(savePasswordButton);

                            savePasswordButton.click(function () {
                                var newPassword = passwordInput.val();
                                var newUserData = {
                                    id: user.id,
                                    password: newPassword,
                                    name: user.name,
                                    surname: user.surname,
                                    street: user.street,
                                    housenumber: user.housenumber,
                                    postalcode: user.postalcode,
                                    country: user.country,
                                    email: user.email,
                                };

                                $.ajax({
                                    url: 'http://localhost:8080/user/' + user.id,
                                    method: 'PUT',
                                    dataType: 'json',
                                    contentType: 'application/json',
                                    data: JSON.stringify(newUserData),
                                    success: function (response) {
                                        console.log('Password updated successfully:', response);
                                        location.reload();
                                        window.alert('Passwort wurde geändert.');
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Error updating password:', xhr, status, error);
                                    }
                                });
                            });
                        });
                        changeNameButton.click(function () {
                            var nameInput = $('<input type="text">');
                            var saveButton = $('<button>Speichern</button>');
                            userDiv.find('.user-name').replaceWith(nameInput);
                            userDiv.find('#changeNameButton').empty().append(saveButton);

                            saveButton.click(function () {
                                var newName = nameInput.val();
                                var newUserData = {
                                    id: user.id,
                                    name: newName,
                                    surname: user.surname,
                                    street: user.street,
                                    housenumber: user.housenumber,
                                    postalcode: user.postalcode,
                                    country: user.country,
                                    email: user.email,
                                    password: user.password,
                                };
                                console.log('New User Data:', newUserData);

                                $.ajax({
                                    url: 'http://localhost:8080/user/' + user.id,
                                    method: 'PUT',
                                    dataType: 'json',
                                    contentType: 'application/json',
                                    data: JSON.stringify(newUserData),
                                    success: function (response) {
                                        console.log('User data updated successfully:', response);
                                        location.reload();
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Error updating user data:', xhr, status, error);
                                    }
                                });

                            });
                        });
                    });
                }
            },
            error: function (xhr, status, error) {
                console.error(xhr, status, error);
            }
        });
    });


</script>
<script>
    $(document).ready(function () {
        $.ajax({
            url: 'http://localhost:8080/cart',
            method: 'GET',
            dataType: 'json',
            success: function (ordersData) {
                console.log(ordersData);
                if (ordersData.length === 0) {
                    $('#noOrdersMessage').show();
                } else {
                    $('#ordersList').empty();

                    ordersData.forEach(function (order) {
                        var orderDiv = $('<div class="cart"></div>');

                        orderDiv.append('<p>Rechnungsnummer: ' + order.id + '</p>');
                        orderDiv.append('<p>Kunde: ' + order.user.name + ' ' + order.user.surname + '</p>');

                        // produkte anzeigen
                        orderDiv.append('<img src="original.url" alt="product-picture">');
                        orderDiv.append('<p>Produkttitel: ' + order.original.title + '</p>');
                        orderDiv.append('<p>Größe: ' + order.original.size + '</p>');
                        orderDiv.append('<p>Material: ' + order.original.material + '</p>');
                        orderDiv.append('<p>Kategorie: ' + order.original.category + '</p>');
                        orderDiv.append('<p>Preis: € ' + order.original.price + '</p>');
                        orderDiv.append('<p>Größe: ' + order.original.size + '</p>');

                        orderDiv.append('<p>Total: ' + order.total + '</p>');
                        $('#ordersList').append(orderDiv);
                    });
                }
            },
            error: function (xhr, status, error) {
                console.error('Error fetching orders:', xhr, status, error);
            },
        });
    });
</script>
<script>
    //////////////////////////////////////////////////////////////
    ////////////// PRODUCTS /////////////////////
    //////////////////////////////////////////////////////////////

    $(document).ready(function () {

        //////////////////////////////////////////////////////////////
        ////////////// GET ALL PRODUCTS /////////////////////
        //////////////////////////////////////////////////////////////

        $.ajax({
            url: 'http://localhost:8080/original',
            method: 'GET',
            dataType: 'json',
            success: function (productsData) {
                if (productsData.length === 0) {
                    $('#noProductsMessage').show();
                } else {
                    console.log(productsData);
                    $('#productsList').empty();

                    productsData.forEach(function (original) {
                        var productDiv = $('<div class="cart"></div>');

                        productDiv.append('<p class="id text-center">ID: ' + original.id + '</p>');

                        var imageInput = $('<input type="url" class="edit-url form-control" value="' + original.url + '" readonly>');
                        productDiv.append(imageInput);

                        productDiv.append('<div class="form-group"><label>Titel</label><input type="text" class="edit-title form-control" value="' + original.title + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Größe</label><input type="text" class="edit-size form-control" value="' + original.size + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Material</label><input type="text" class="edit-material form-control" value="' + original.material + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Description</label><input type="text" class="edit-description form-control" value="' + original.description + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Kategorie</label><input type="text" class="edit-category form-control" value="' + original.category + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Preis</label><input type="number" class="edit-price form-control" value="' + original.price + '" readonly></div>');
                        productDiv.append('<div class="form-group"><label>Stückzahl</label><input type="text" class="edit-quantity form-control" value="' + original.quantity + '" readonly></div>');
                        productDiv.append('<div class="register-container"><button class="btn btn-primary edit-product">Bearbeiten</button></div>');
                        productDiv.append('<div class="register-container"><button class="btn btn-danger delete-product">Löschen</button></div>');
                        productDiv.append('<div class="register-container"><button class="btn btn-success save-changes" style="display: none;">Änderungen speichern</button></div>');
                        $('#productsList').append(productDiv);
                    });
                }
            },
            error: function (xhr, status, error) {
                console.error('Error fetching orders:', xhr, status, error);
            },
        });

        //////////////////////////////////////////////////////////////
        ////////////// ADD NEW PRODUCT /////////////////////
        //////////////////////////////////////////////////////////////


        $('#productForm').submit(function (event) {
            event.preventDefault();

            // make an object from the form data
            var formData = {
                "id": 0,
                "title": $("#title").val(),
                "size": $("#size").val(),
                "material": $("#material").val(),
                "description": $("#description").val(),
                "price": $("#price").val(),
                "url": $("#url").val(),
                "category": $('[name="category"]').val(),
                "quantity": $("#quantity").val()
            };

            console.log(formData);

            var jsonString = JSON.stringify(formData);

            $.ajax({
                type: 'POST',
                url: 'http://localhost:8080/original',
                data: jsonString,
                contentType: 'application/json',
                success: function (response) {
                    console.log(response);
                },
                error: function (error) {
                    console.error(error);
                }
            });
        });

        //////////////////////////////////////////////////////////////
        ////////////// EDIT PRODUCT /////////////////////
        //////////////////////////////////////////////////////////////

        // event handler for edit-button
        $('#productsList').on('click', '.edit-product', function () {
            var $productDiv = $(this).closest('.cart');
            $productDiv.find('.edit-url, .edit-title, .edit-size, .edit-material, .edit-category, .edit-price, .edit-quantity', '.edit-description').prop('readonly', false);
            $productDiv.find('.edit-product').hide();
            $productDiv.find('.save-changes').show();
        });

        // event listener for the Save Changes - Button - with the productList ID to make it work
        $('#productsList').on('click', '.save-changes', function () {
            var $productDiv = $(this).closest('.cart');
            var productId = parseInt($productDiv.find('p:contains("ID:")').text().split(':')[1].trim(), 10);
            var editedData = {
                id: productId,
                url: $productDiv.find('.edit-url').val(),
                title: $productDiv.find('.edit-title').val(),
                size: $productDiv.find('.edit-size').val(),
                material: $productDiv.find('.edit-material').val(),
                category: $productDiv.find('.edit-category').val(),
                description: $productDiv.find('.edit-description').val(),
                price: parseFloat($productDiv.find('.edit-price').val()),
                quantity: parseInt($productDiv.find('.edit-quantity').val()),
            };
            console.log(editedData);
            var jsonStringEditedData = JSON.stringify(editedData);
            console.log(jsonStringEditedData);


            $.ajax({
                type: 'PUT',
                url: 'http://localhost:8080/original/' + productId,
                data: jsonStringEditedData,
                contentType: 'application/json',
                success: function (response) {
                    // Handle the success response
                    console.log('Product updated:', response);

                    // disable the other buttons
                    $productDiv.find('.edit-title, .edit-size, .edit-material, .edit-category, .edit-price, .edit-url, .edit-quantity, .edit-description').prop('readonly', true);
                    $productDiv.find('.edit-product').show();
                    $productDiv.find('.save-changes').hide();
                },
                error: function (error) {
                    console.error('Error updating product:', error);
                }
            });
        });


        //////////////////////////////////////////////////////////////
        ////////////// DELETE PRODUCT /////////////////////
        //////////////////////////////////////////////////////////////


        $('#productsList').on('click', '.delete-product', function () {
            var $productDiv = $(this).closest('.cart');
            var productId = parseInt($productDiv.find('.id').text().split(':')[1].trim(), 10);

            if (confirm('Are you sure you want to delete this product?')) {
                $.ajax({
                    type: 'DELETE',
                    url: 'http://localhost:8080/original/' + productId,
                    success: function (response) {
                        console.log('Product deleted:', response);
                        $productDiv.remove();
                    },
                    error: function (error) {
                        console.error('Error deleting product:', error);
                    }
                });
            }
        });
    });</script>
